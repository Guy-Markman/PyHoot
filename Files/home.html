<!doctype html>
<html>

	<head>
		<link rel="stylesheet" type="text/css" href="common.css" />
		<link rel="stylesheet" type="text/css" href="home.css" />
		<link href="https://fonts.googleapis.com/css?family=Ravi+Prakash" rel="stylesheet">
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>PyHoot!</title>
		<link rel="icon" type="image/png" href="icon.png">

		<script src="util.js"></script>
		<script>
			function changeDiv() {
				document.getElementById('p1').style.display =
					"none";
				document.getElementById('p2').style.display =
					"inline";
				document.getElementById('name').focus();
			}

			function check_length_name() {
				if (document.getElementById("name").value.length >= 3) {
					check("name");
				} else {
					document.getElementById("p2_title").innerHTML =
						"Name too short, at least 3 characters";
				}
			}

			function check(type) { //Check if name / test exist
				var data = document.getElementById("join_number").value;
				if (type == "name") {
					data += "&name=" + document.getElementById("name")
						.value;
				}
				xmlrequest("check_" + type + "?join_number=" + data,
					function() {
						if (this.readyState == 4 && this.status == 200) {
							var ans = xmlstring_to_boolean(this.responseText);
							if (type == "test") {
								if (ans) {
									changeDiv();
								} else {
									document.getElementById("p1_title").innerHTML =
										"No such Game Pin, enter right one";
								}
							} else if (type == "name") {
								if (ans) {
									document.getElementById("join").submit();
								} else {
									document.getElementById("p2_title").innerHTML =
										"Name taken, choose another name";
								}
							}
						}
					}
				);
			}
		</script>
	</head>

	<body>
		<center>
			<form id="join" action="/join" method="get">
				<div id="p1">
					<div id="p1_title" class="title">Game PIN</div><br />
					<input type="number" inputmode="numeric" pattern="\d*" title="Non-negative integral number" id="join_number" name="join_number" style="width: 200px;" min="100000" max="999999" autocomplete="off" autofocus>
					<br /><br />
					<button type="button" class="check_test" onclick="check('test');">
						Join!</button><br /><br />
					<button type="button" class="move" onclick="location.href='/new'">
					Creat new game </button>
				</div>
				<div id="p2" class="p2">
					<div id="p2_title" class="title">Choose name</div><br />
					<input type="text" name="name" id="name" pattern=".{3,}" required title="3 characters minimum"><br /><br />
					<button type="button" class="move" style="" onclick="check_length_name()">
				     Start Playing!</button>
				</div>
			</form>

		</center>
	</body>

</html>
